<div class="user-profile">
  <!-- Avatar and Basic Info -->
  <div class="profile-header">
    <div class="avatar-section">
      <div class="avatar">{{ userInitials() }}</div>
      <button class="edit-avatar-btn" type="button">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" stroke="currentColor" stroke-width="2"/>
          <path d="m18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2"/>
        </svg>
      </button>
    </div>
  </div>

  <!-- Profile Form -->
  <form [formGroup]="profileForm" (ngSubmit)="saveProfile()" class="profile-form">
    <div class="form-row">
      <div class="form-group">
        <label for="firstName">Nombre</label>
        @if (isEditMode()) {
          <input
            id="firstName"
            type="text"
            formControlName="firstName"
            class="form-control"
            [class.error]="profileForm.get('firstName')?.invalid && profileForm.get('firstName')?.touched"
          />
        } @else {
          <div class="form-display">{{ profileForm.get('firstName')?.value || '-' }}</div>
        }
        @if (profileForm.get('firstName')?.invalid && profileForm.get('firstName')?.touched) {
          <div class="error-message">El nombre es requerido (mínimo 2 caracteres)</div>
        }
      </div>

      <div class="form-group">
        <label for="lastName">Apellido</label>
        @if (isEditMode()) {
          <input
            id="lastName"
            type="text"
            formControlName="lastName"
            class="form-control"
            [class.error]="profileForm.get('lastName')?.invalid && profileForm.get('lastName')?.touched"
          />
        } @else {
          <div class="form-display">{{ profileForm.get('lastName')?.value || '-' }}</div>
        }
        @if (profileForm.get('lastName')?.invalid && profileForm.get('lastName')?.touched) {
          <div class="error-message">El apellido es requerido (mínimo 2 caracteres)</div>
        }
      </div>
    </div>

    <div class="form-group">
      <label for="email">Correo electrónico</label>
      @if (isEditMode()) {
        <input
          id="email"
          type="email"
          formControlName="email"
          class="form-control"
          [class.error]="profileForm.get('email')?.invalid && profileForm.get('email')?.touched"
        />
      } @else {
        <div class="form-display">{{ profileForm.get('email')?.value || '-' }}</div>
      }
      @if (profileForm.get('email')?.invalid && profileForm.get('email')?.touched) {
        <div class="error-message">Ingresa un correo electrónico válido</div>
      }
    </div>

    <!-- Action Buttons -->
    <div class="form-actions">
      @if (isEditMode()) {
        <button
          type="button"
          class="btn btn-secondary"
          (click)="toggleEditMode()"
          [disabled]="isLoading()"
        >
          Cancelar
        </button>
        <button
          type="submit"
          class="btn btn-primary"
          [disabled]="profileForm.invalid || isLoading()"
        >
          @if (isLoading()) {
            Guardando...
          } @else {
            Guardar cambios
          }
        </button>
      } @else {
        <button
          type="button"
          class="btn btn-primary"
          (click)="toggleEditMode()"
        >
          Editar perfil
        </button>
      }
    </div>
  </form>

  <!-- Tournaments Section -->
  <div class="tournaments-section">
    <h3 class="section-title">Mis Torneos</h3>
    
    @if (userTournaments().length > 0) {
      <div class="tournaments-table">
        <div class="table-header">
          <div class="header-cell">Torneo</div>
          <div class="header-cell">Fecha</div>
          <div class="header-cell">Estado</div>
        </div>
        
        @for (tournament of userTournaments(); track tournament.id) {
          <div class="table-row">
            <div class="cell tournament-name">{{ tournament.name }}</div>
            <div class="cell tournament-date">{{ tournament.date }}</div>
            <div class="cell tournament-status">
              <span class="status-badge" [ngClass]="getStatusClass(tournament.status)">
                {{ tournament.status }}
              </span>
            </div>
          </div>
        }
      </div>
    } @else {
      <div class="empty-state">
        <p>No tienes torneos registrados aún.</p>
        <a routerLink="/tournaments" class="btn btn-outline">Explorar torneos</a>
      </div>
    }
  </div>
</div>
